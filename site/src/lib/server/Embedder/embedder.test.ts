import { describe, it, expect, beforeEach } from "vitest"
import Embedder from "./embedder"

describe("Embedder", () => {
  let embedder: Embedder
  beforeEach(() => {
    embedder = Embedder()
  })

  it("calculates embeddings", async () => {
    const result = await embedder.embed("A query")

    expect(result).toMatchInlineSnapshot(`
      [
        0.050543155521154404,
        0.08753634244203568,
        0.01181693933904171,
        0.09241687506437302,
        -0.11664074659347534,
        0.08489935100078583,
        0.20307514071464539,
        0.023450937122106552,
        0.05914284661412239,
        -0.037262339144945145,
        0.042347658425569534,
        -0.07766032963991165,
        0.0748390406370163,
        -0.06975451111793518,
        -0.061414726078510284,
        0.010721241123974323,
        -0.006316645536571741,
        0.00008488215098623186,
        -0.04850366711616516,
        -0.0244891420006752,
        -0.07166320830583572,
        0.03237628936767578,
        -0.05660427734255791,
        0.05967342108488083,
        -0.004916799254715443,
        0.0263668242841959,
        0.03947346657514572,
        0.0021904814057052135,
        0.05102705955505371,
        -0.06409977376461029,
        -0.1111527681350708,
        0.04513279348611832,
        0.05088872089982033,
        0.07109980285167694,
        0.03121059201657772,
        -0.09755538403987885,
        0.009771652519702911,
        -0.017428502440452576,
        0.012803271412849426,
        -0.03372893109917641,
        -0.007047782652080059,
        -0.10403171181678772,
        0.04490845650434494,
        -0.0026126697193831205,
        -0.05350187420845032,
        0.04382599890232086,
        -0.0736670047044754,
        0.07503542304039001,
        0.006206478923559189,
        -0.00009335429786005989,
        -0.14951348304748535,
        0.01803298108279705,
        -0.09919391572475433,
        -0.035844601690769196,
        0.03665517270565033,
        -0.020634755492210388,
        -0.10558540374040604,
        -0.0038472290616482496,
        -0.024084823206067085,
        0.0406450591981411,
        0.028826246038079262,
        -0.009373488835990429,
        0.039579395204782486,
        0.05062238126993179,
        0.042372021824121475,
        -0.07894132286310196,
        -0.000758326263166964,
        -0.014637543819844723,
        0.030612051486968994,
        -0.05534744635224342,
        0.008302324451506138,
        0.006554172374308109,
        -0.027912823483347893,
        0.04908998683094978,
        0.005718165542930365,
        -0.014530498534440994,
        -0.03218531608581543,
        -0.03651443123817444,
        0.08494104444980621,
        0.00015885330503806472,
        -0.03826059401035309,
        -0.030795477330684662,
        -0.06459329277276993,
        0.051251187920570374,
        0.0889078676700592,
        -0.058842793107032776,
        0.07197899371385574,
        -0.03988586738705635,
        0.05255219712853432,
        -0.025964787229895592,
        -0.07233226299285889,
        0.014986090362071991,
        0.012906703166663647,
        0.0011009465670213103,
        -0.021647989749908447,
        0.0012673269957304,
        0.051427729427814484,
        -0.04306153953075409,
        0.08020267635583878,
        0.18643569946289062,
        0.022049352526664734,
        0.050745993852615356,
        -0.06110244244337082,
        -0.047143708914518356,
        -0.13135845959186554,
        0.00014145676686894149,
        -0.029307203367352486,
        -0.021702183410525322,
        0.02507905103266239,
        -0.025769222527742386,
        -0.07047874480485916,
        -0.03456711396574974,
        0.019982637837529182,
        -0.011188913136720657,
        0.012444332242012024,
        -0.048803433775901794,
        0.0397147536277771,
        0.023000918328762054,
        -0.007980083115398884,
        -0.050298918038606644,
        0.07551134377717972,
        0.07076966762542725,
        -0.026841705664992332,
        -0.029542196542024612,
        -0.029765648767352104,
        -0.03985624760389328,
        0.04000013321638107,
        -6.057591284119998e-33,
        0.00023951598268467933,
        -0.026144148781895638,
        0.03007003478705883,
        -0.007737819571048021,
        -0.03344787284731865,
        0.025885339826345444,
        -0.038462765514850616,
        0.02645902894437313,
        -0.025196680799126625,
        0.038075413554906845,
        -0.042738307267427444,
        0.018229980021715164,
        0.04164678230881691,
        0.0007342282915487885,
        0.05825819820165634,
        0.0035804419312626123,
        0.08238765597343445,
        0.017751283943653107,
        -0.0381733775138855,
        -0.00987179670482874,
        -0.0565020926296711,
        -0.00812440924346447,
        0.02498495765030384,
        0.09925403445959091,
        0.07197098433971405,
        -0.048685647547245026,
        -0.030369658023118973,
        -0.0330512635409832,
        0.018490271642804146,
        0.021615130826830864,
        0.010609685443341732,
        0.005423972383141518,
        -0.0818466767668724,
        -0.0981309711933136,
        0.038086723536252975,
        -0.025377627462148666,
        0.0451665036380291,
        -0.023102732375264168,
        0.055420633405447006,
        0.030009442940354347,
        -0.029160041362047195,
        -0.014192014001309872,
        0.07478678226470947,
        -0.06748315691947937,
        -0.0259908027946949,
        -0.010124779306352139,
        0.015126914717257023,
        -0.008994948118925095,
        -0.009735533967614174,
        0.026093559339642525,
        -0.036074381321668625,
        -0.03936118260025978,
        -0.05487659573554993,
        -0.01158873736858368,
        0.07094329595565796,
        -0.0115733090788126,
        -0.028917785733938217,
        0.10089321434497833,
        0.0036751884035766125,
        0.08553628623485565,
        -0.0010408665984869003,
        -0.02372463047504425,
        -0.0145425945520401,
        -0.03548704832792282,
        0.001031061401590705,
        -0.014356257393956184,
        0.014952395111322403,
        -0.019098570570349693,
        0.11766401678323746,
        -0.0036903645377606153,
        -0.0024777355138212442,
        -0.037654392421245575,
        0.05402389541268349,
        -0.040183670818805695,
        -0.056509777903556824,
        0.012532834894955158,
        0.022997882217168808,
        0.041558075696229935,
        -0.024869240820407867,
        0.02900448627769947,
        -0.07346052676439285,
        -0.083730049431324,
        0.010853446088731289,
        0.023761244490742683,
        -0.012841985560953617,
        0.03730709105730057,
        0.015279704704880714,
        -0.0248155165463686,
        0.03291214630007744,
        -0.018593596294522285,
        -0.05829273536801338,
        0.006236253306269646,
        0.005822139326483011,
        0.02408342808485031,
        0.048677317798137665,
        2.6108495439800963e-33,
        -0.04427867382764816,
        0.0038912424352020025,
        -0.054602641612291336,
        -0.009611507877707481,
        0.031883884221315384,
        -0.0922979936003685,
        0.03375406190752983,
        -0.08687084913253784,
        -0.0622282400727272,
        0.04697921499609947,
        0.017299626022577286,
        -0.021436400711536407,
        0.09505317360162735,
        -0.06408650428056717,
        0.0548473484814167,
        0.0894479751586914,
        0.08347715437412262,
        -0.04430416226387024,
        -0.057047612965106964,
        0.0719289779663086,
        -0.0840589627623558,
        0.019688474014401436,
        -0.018879884853959084,
        -0.0019940934143960476,
        -0.012253517284989357,
        0.03485861420631409,
        0.0022956025786697865,
        -0.01021484099328518,
        -0.04652627930045128,
        0.01286693848669529,
        0.03603343293070793,
        -0.15779174864292145,
        0.01435962226241827,
        0.0034247662406414747,
        -0.04093371331691742,
        -0.03155328705906868,
        0.04290437325835228,
        -0.010794087313115597,
        -0.029093028977513313,
        0.06441112607717514,
        0.07285468280315399,
        -0.0035657912958413363,
        0.09220317006111145,
        0.1653958410024643,
        0.008954301476478577,
        -0.0036394656635820866,
        -0.05133162811398506,
        0.0019449461251497269,
        0.04512583464384079,
        0.014396474696695805,
        -0.02757837250828743,
        0.02683473378419876,
        0.006121561396867037,
        -0.014679034240543842,
        -0.01837216690182686,
        0.01621958799660206,
        -0.06896995007991791,
        0.0052642072550952435,
        0.05641002580523491,
        0.011400843970477581,
        -0.0019294326193630695,
        0.10614138841629028,
        -0.03041417896747589,
        0.056205298751592636,
        -0.011538699269294739,
        -0.016024861484766006,
        -0.05683721974492073,
        -0.021214287728071213,
        -0.04433872923254967,
        0.04033064469695091,
        0.03738195449113846,
        0.00965183973312378,
        0.00757687957957387,
        -0.02239784598350525,
        -0.03581659868359566,
        0.026008250191807747,
        -0.08495157212018967,
        0.03138386830687523,
        -0.027846619486808777,
        0.025652525946497917,
        -0.07804588228464127,
        0.045351993292570114,
        0.03743113577365875,
        0.033631980419158936,
        -0.04426577314734459,
        -0.013088062405586243,
        0.051532480865716934,
        -0.0049319276586174965,
        -0.004897557199001312,
        0.0015228718984872103,
        0.059198521077632904,
        -0.0142819220200181,
        -0.07001069188117981,
        -0.10518941283226013,
        0.01733165793120861,
        -1.3968658230112396e-8,
        -0.044643204659223557,
        -0.05374912545084953,
        -0.06221058592200279,
        0.008307121694087982,
        0.1600361168384552,
        0.020028943195939064,
        -0.009688728488981724,
        0.07231127470731735,
        -0.06464696675539017,
        0.04269139841198921,
        0.06441918015480042,
        -0.022410791367292404,
        0.019444581121206284,
        0.032591599971055984,
        0.02426455356180668,
        -0.0262227114289999,
        -0.09092532098293304,
        0.0147258210927248,
        -0.044675182551145554,
        -0.0991000384092331,
        -0.025112442672252655,
        -0.012973729521036148,
        0.001812670729123056,
        0.02131468988955021,
        -0.02748636156320572,
        0.0348077118396759,
        -0.03780263289809227,
        -0.02806825377047062,
        0.049702756106853485,
        0.05835290625691414,
        -0.015836499631404877,
        0.037705302238464355,
        0.0649293065071106,
        -0.026801008731126785,
        0.05912075564265251,
        -0.0789947584271431,
        0.010176676325500011,
        -0.0356685109436512,
        -0.04673416167497635,
        -0.07188498228788376,
        0.018084581941366196,
        -0.01026081945747137,
        -0.02869848534464836,
        0.04916270822286606,
        -0.01552883442491293,
        -0.12161751836538315,
        0.04470665380358696,
        -0.040524110198020935,
        0.010471167974174023,
        -0.03214952349662781,
        -0.006407624576240778,
        -0.04838046431541443,
        0.08930204808712006,
        0.0008670781971886754,
        -0.06985633075237274,
        0.026659004390239716,
        0.033854033797979355,
        0.007791566662490368,
        -0.0642094835639,
        -0.044054608792066574,
        0.017206674441695213,
        0.014174358919262886,
        -0.011126795783638954,
        0.09099084883928299,
      ]
    `)
  })
})
